language: go
go_import_path: blunt.sh/wtfcmd
go: 1.8
install:
  - go get github.com/mattn/go-isatty
  - go get gopkg.in/yaml.v2

branches:
  only:
    - /^v[0-9]+\.[0-9]+\.[0-9]+$/

sudo: false
os:
  - osx
  - linux

script:
  - cd $GOPATH/src/blunt.sh/wtfcmd
  - go test blunt.sh/wtfcmd/wtf
  - go run assetbuilder/build.go $(pwd)/assets
  - go install blunt.sh/wtfcmd/wtf

before_deploy:
    - "mv $GOPATH/bin/wtf $GOPATH/bin/wtf.$TRAVIS_OS_NAME"

deploy:
  provider: releases
  api_key:
    - secure: "TODO"
  file_glob: true
  file: "$GOPATH/bin/wtf.$TRAVIS_OS_NAME"
  skip_cleanup: true
  on:
    tags: true